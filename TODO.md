# CC Mirror â€” å®Œæ•´ TODO

> çŠ¶æ€ï¼šPhase 0 å®Œæˆï¼ˆåŸºç¡€è®¾æ–½ + ä»£ç æ¡†æ¶ï¼‰
> ä¸‹æ¬¡ session å¼€å§‹å‘½ä»¤ï¼š`/cc-mirror-dev` â†’ çœ‹ CLAUDE.md å½“å‰çŠ¶æ€
> æµ‹è¯•å¯¹è±¡ï¼š`~/.claude/projects/-Users-nature------Towow/`

---

## Phase 0ï¼šæ•°æ®éªŒè¯ï¼ˆå½“å‰é˜¶æ®µï¼‰

### âœ… å·²å®Œæˆ
- [x] é¡¹ç›®ç»“æ„å»ºç«‹ï¼ˆstandaloneï¼Œä¸æ·· Towowï¼‰
- [x] `docs/DESIGN.md`ï¼ˆ9 æ¡ ADRï¼Œæ¶æ„å†³ç­–ï¼‰
- [x] `CLAUDE.md`ï¼ˆä¼šè¯å‹ç¼©åè®®ï¼‰
- [x] Skillsï¼š`cc-mirror-dev` + `cc-mirror-lab`
- [x] `src/cc_mirror/db.py`ï¼ˆSQLite schemaï¼Œ8å¼ è¡¨ï¼‰
- [x] `src/cc_mirror/l1_parser.py`ï¼ˆJSONL â†’ SQLite è§£æå™¨ï¼‰
- [x] `src/cc_mirror/cli.py`ï¼ˆClick CLI skeletonï¼‰
- [x] `pyproject.toml`ï¼ˆpip åŒ…é…ç½®ï¼‰
- [x] `tests/fixtures/sample_session.jsonl`ï¼ˆ11æ¡æ¶ˆæ¯æµ‹è¯•æ•°æ®ï¼‰
- [x] `tests/test_l1_parser.py`ï¼ˆ5ä¸ª smoke testï¼‰
- [x] git åˆå§‹åŒ– + ç¬¬ä¸€æ¬¡ commit

### ğŸš¨ ç«‹å³ä¸‹ä¸€æ­¥ï¼ˆPhase 0 éªŒæ”¶ï¼‰

```bash
# 1. å®‰è£…
cd ~/ä¸ªäººé¡¹ç›®/cc-mirror
pip install -e .

# 2. è¿è¡Œ smoke testï¼ˆæœ€å°æµ‹è¯•ï¼‰
python -m pytest tests/ -v

# 3. è¿è¡Œ scan åœ¨ Towow æ•°æ®ä¸Šï¼ˆè¿™æ˜¯ç¬¬ä¸€ç”¨æˆ·æµ‹è¯•ï¼‰
cc-mirror scan --claude-dir ~/.claude \
  --project -Users-nature------Towow \
  --verbose

# 4. æŠŠè¾“å‡ºç»™ç”¨æˆ·çœ‹ï¼Œè®©ç”¨æˆ·åˆ¤æ–­æ•°å­—æ˜¯å¦åˆç†
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] pytest 5 ä¸ª test é€šè¿‡
- [ ] Towow scan è¾“å‡ºï¼šsessions æ•°åˆç†ï¼ˆåº”è¯¥ 50+ï¼‰
- [ ] å€™é€‰çº æ­£ç‡ 10-30%ï¼ˆå¤ªä½ â†’ ç²—ç­› bugï¼Œå¤ªé«˜ â†’ ç²—ç­›å¤ªæ¾ï¼‰
- [ ] Repeated prompts â‰¥ 3 ä¸ª unique patterns

---

## Phase 1ï¼šæ ¸å¿ƒç®¡çº¿ï¼ˆPhase 0 éªŒæ”¶åï¼‰

### L2ï¼šçº æ­£æ£€æµ‹
- [ ] `src/cc_mirror/l2_correction.py`
  - ä» messages è¡¨è¯»å–å€™é€‰çº æ­£ï¼ˆis_candidate_correction=TRUEï¼‰
  - æ„é€  promptï¼ˆå€™é€‰æ¶ˆæ¯ + å‰ 1-3 æ¡ assistant æ¶ˆæ¯ï¼Œ< 3k tokensï¼‰
  - è°ƒç”¨ Sonnetï¼Œæ¸©åº¦=0ï¼Œè¾“å‡º JSONï¼š{is_correction, cc_did, user_wanted, correction_type, is_generalizable, confidence}
  - å†™å…¥ corrections è¡¨
  - è®°å½•åˆ° llm_calls è¡¨
  - å¹¶å‘ï¼š20 ä¸ª asyncio taskï¼ˆ--parallelism å‚æ•°ï¼‰

### L2ï¼šå·¥ä½œæµèšç±»
- [ ] `src/cc_mirror/l2_workflow.py`
  - ä» tool_calls è¡¨æå–æ¯ä¸ª session çš„å·¥å…·ååºåˆ—
  - LCS + å±‚æ¬¡èšç±»ï¼ˆé˜ˆå€¼ 0.6ï¼Œè°ƒä¼˜èŒƒå›´ 0.5-0.8ï¼‰
  - å¯¹æ¯ä¸ªèšç±»è°ƒç”¨ Sonnet åˆ†æä»»åŠ¡ç±»å‹
  - å†™å…¥ workflow_clusters è¡¨

### L2ï¼šé‡å¤æç¤ºï¼ˆæ¨¡ç³ŠåŒ¹é…ï¼‰
- [ ] `src/cc_mirror/l2_repeated_prompts.py`
  - L1 å·²åšç²¾ç¡®åŒ¹é…ï¼ˆå†™å…¥ repeated_prompts è¡¨ï¼‰
  - L2 åš 3-gram æ¨¡ç³ŠåŒ¹é…ï¼ˆç›¸ä¼¼åº¦ > 0.7ï¼‰
  - å¯¹é«˜é¢‘èšç±»è°ƒç”¨ Sonnet åˆ†ææ„å›¾ + å»ºè®®å†™å…¥ä½ç½®

### L3ï¼šèšåˆåˆ†æ
- [ ] `src/cc_mirror/l3_aggregator.py`
  - çº æ­£èšåˆï¼šæŒ‰ correction_type åˆ†ç»„ â†’ è¯­ä¹‰èšç±» â†’ CLAUDE.md è§„åˆ™ç”Ÿæˆï¼ˆOpusï¼‰
  - Skill å»ºè®®ï¼šå¯¹æ¯ä¸ª workflow_cluster ç”Ÿæˆ Skill å»ºè®®æ­¥éª¤ï¼ˆOpusï¼‰
  - é‡å¤æç¤ºæ¶ˆé™¤æ¸…å•ï¼ˆSonnetï¼‰

### Budget æ§åˆ¶
- [ ] `src/cc_mirror/budget.py`
  - `BudgetController` ç±»ï¼šè®°å½•æˆæœ¬ï¼Œè¿”å›ç­–ç•¥ï¼ˆfull/p0_only/stopï¼‰
  - é›†æˆåˆ° cli.py çš„ analyze å‘½ä»¤

### Phase 1 éªŒæ”¶ï¼ˆAgent Teamï¼‰
```
Agent A: l2_correction.py
Agent B: l2_workflow.py + l2_repeated_prompts.py
Agent C: budget.py + l3_aggregator.py
â†’ é¡ºåºï¼šA+B â†’ Cï¼ˆä¾èµ–A+Bçš„è¡¨æ•°æ®ï¼‰
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] `cc-mirror analyze` åœ¨ Towow æ•°æ®ä¸Šè¿è¡Œå®Œæˆ
- [ ] äº§å‡º `suggested-rules.md`ï¼ˆè‡³å°‘ 3 æ¡è§„åˆ™å»ºè®®ï¼‰
- [ ] äº§å‡º `suggested-skills.md`ï¼ˆè‡³å°‘ 1 ä¸ª Skill å»ºè®®ï¼‰
- [ ] æŠŠäº§å‡ºç»™ç”¨æˆ·çœ‹ï¼ˆäººå·¥åˆ¤æ–­æ˜¯å¦æœ‰ä»·å€¼ï¼‰
- [ ] llm_calls è¡¨è®°å½•äº†æ‰€æœ‰è°ƒç”¨ï¼ˆå¯å®¡è®¡ï¼‰
- [ ] æ€»æˆæœ¬åœ¨ $20 ä»¥å†…ï¼ˆTowow é¡¹ç›®ï¼‰

---

## Phase 2ï¼šæŠ¥å‘Šç”Ÿæˆï¼ˆPhase 1 éªŒæ”¶åï¼‰

### L4ï¼šå®Œæ•´æŠ¥å‘Š
- [ ] `src/cc_mirror/templates/report.html.j2`
  - ç¬¬ä¸€å±ï¼šæˆå°±ä»ªè¡¨ç›˜ï¼ˆ5ä¸ªæ•°å­— + ä¸€å¥è¯ç”»åƒï¼‰
  - Part 1ï¼šåŠ¡å®äº§å‡ºï¼ˆè§„åˆ™/Skill/å·¥ä½œæµï¼Œå«å¤åˆ¶æŒ‰é’®ï¼‰
  - Part 2ï¼šæ€ç»´æå–ï¼ˆåˆ†è§£æ¨¡å¼ã€å†³ç­–æ¡†æ¶ã€å…ƒè®¤çŸ¥ï¼‰
  - Part 3ï¼šæˆé•¿æ¦‚è§ˆï¼ˆè¶‹åŠ¿å›¾ã€å·¥å…·æ¼”åŒ–ã€æ•ˆç‡æŒ‡æ ‡ï¼‰
  - å†…è” SVG + vanilla JS < 200 è¡Œï¼ˆæ— å¤–éƒ¨ä¾èµ–ï¼‰
  - å¤åˆ¶æŒ‰é’®ç”¨ `document.execCommand('copy')` fallback

- [ ] `src/cc_mirror/l4_renderer.py`
  - `render_report(analysis_results, output_dir)` â†’ report.html
  - `render_share_card(analysis_results, output_dir)` â†’ share-card.html + share-card.png

### L4ï¼šåˆ†äº«å¡ç‰‡
- [ ] `src/cc_mirror/templates/share_card.html.j2`
  - 1080Ã—1920 ç«–å± + 1200Ã—630 OG å°ºå¯¸
  - å¤§æ•°å­—ï¼ˆ48px+ï¼‰ã€æ¸å˜èƒŒæ™¯ã€è®¤çŸ¥æ ‡ç­¾ pills
  - éšç§è„±æ•ï¼ˆä¸å«é¡¹ç›®åã€ä»£ç ã€session IDï¼‰
  - "Generated by CC Mirror" æ°´å°

### P1ï¼šæ€ç»´æå–ï¼ˆåœ¨ Phase 2 æœŸé—´å®ç°ï¼‰
- [ ] `src/cc_mirror/l2_thinking.py`ï¼ˆå¯é€‰ï¼Œå¦‚æœé¢„ç®—å…è®¸ï¼‰
  - é—®é¢˜åˆ†è§£æ¨¡å¼æ£€æµ‹
  - å†³ç­–æ¡†æ¶æå–
  - å…ƒè®¤çŸ¥æ¨¡å¼

### P2ï¼šæˆé•¿åˆ†æï¼ˆåœ¨ Phase 2 æœŸé—´å®ç°ï¼‰
- [ ] `src/cc_mirror/l2_growth.py`ï¼ˆå¯é€‰ï¼‰
  - çº æ­£ç‡è¶‹åŠ¿ï¼ˆæŒ‰æœˆï¼‰
  - å·¥å…·ä½¿ç”¨æ¼”åŒ–
  - å¼¯è·¯ç³»æ•°è®¡ç®—

### Phase 2 éªŒæ”¶
```
Agent A: l4_renderer.py + report.html.j2
Agent B: share_card.html.j2 + PNG ç”Ÿæˆ
â†’ é›†æˆæµ‹è¯•ï¼šå®Œæ•´ analyze å‘½ä»¤åœ¨ Towow æ•°æ®ä¸Šè¿è¡Œ
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] ç”¨æµè§ˆå™¨æ‰“å¼€ report.htmlï¼Œç¬¬ä¸€ååº”æ˜¯"è¿™å¯¹æˆ‘æœ‰ç”¨"
- [ ] æ‰“å¼€ share-card.htmlï¼Œæƒ³æˆªå›¾å‘æœ‹å‹åœˆ
- [ ] æ‰€æœ‰å¤åˆ¶æŒ‰é’®å·¥ä½œ
- [ ] åˆ†äº«å¡ç‰‡æ— æ•æ„Ÿä¿¡æ¯

---

## Phase 3ï¼šæ‰“åŒ…å‘å¸ƒï¼ˆPhase 2 éªŒæ”¶åï¼‰

### pip å‘å¸ƒ
- [ ] å†™å®Œæ•´ README.mdï¼ˆå®‰è£… + ä½¿ç”¨ + ç¤ºä¾‹è¾“å‡ºæˆªå›¾ï¼‰
- [ ] è¾¹ç•Œæƒ…å†µå¤„ç†ï¼ˆç©º sessionã€æŸå JSONLã€æ—  CC æ•°æ®ï¼‰
- [ ] Playwright å¯é€‰ä¾èµ–ï¼ˆå®‰è£…äº†è‡ªåŠ¨ç”¨ï¼Œå¦åˆ™ fallbackï¼‰
- [ ] `pyproject.toml` ç‰ˆæœ¬å‡è‡³ 0.1.0
- [ ] GitHub repo åˆ›å»º + push
- [ ] `pip install cc-mirror` æµ‹è¯•
- [ ] `uvx cc-mirror` æµ‹è¯•

### Claude Skill åŒ…è£…ï¼ˆå¯é€‰ï¼‰
- [ ] è®¾è®¡ `/cc-mirror` Skillï¼Œè®©ç”¨æˆ·åœ¨ CC é‡Œç›´æ¥è°ƒç”¨
- [ ] Skill åªåšï¼šè¯» CLAUDE.md + è°ƒç”¨ CLI + å±•ç¤ºç»“æœ

### æ–‡æ¡£
- [ ] docs/ è¡¥å……ï¼šç”¨æˆ·æŒ‡å—ã€å¸¸è§é—®é¢˜ã€éšç§è¯´æ˜
- [ ] CONTRIBUTING.mdï¼ˆå¦‚æœå¼€æºï¼‰

**Phase 3 éªŒæ”¶**ï¼š
- [ ] ä¸€è¡Œå‘½ä»¤ï¼š`uvx cc-mirror analyze --claude-dir ~/.claude`
- [ ] æ€»è€—æ—¶ < 10 åˆ†é’Ÿï¼ˆTowow è§„æ¨¡ï¼‰
- [ ] README æˆªå›¾å¥½çœ‹

---

## æŒç»­å·¥ä½œï¼ˆæ¯ä¸ª Phase æœŸé—´ï¼‰

### æ¶æ„ç»´æŠ¤
- [ ] æ¯æ¬¡æ”¹ db.py schema â†’ æ›´æ–° docs/DESIGN.md å¯¹åº” ADR
- [ ] æ¯æ¬¡æ–°å¢ CLI å‘½ä»¤ â†’ æ›´æ–° CLAUDE.md çš„ CLI å¥‘çº¦

### çŸ¥è¯†æ²‰æ·€
- [ ] è¿è¡Œå®éªŒæ—¶ï¼ˆPhase 0/1 éªŒæ”¶ï¼‰â†’ è®°å½•åˆ° docs/experiments/
  - å€™é€‰çº æ­£ç‡æ ¡å‡†ç»“æœ
  - å·¥ä½œæµèšç±»é˜ˆå€¼è°ƒä¼˜ç»“æœ
  - LLM ç²¾åº¦è¯„ä¼°ï¼ˆ10æ¡äººå·¥åˆ¤æ–­ï¼‰

### ä¸Šä¸‹æ–‡ç®¡ç†ï¼ˆæ¯ sessionï¼‰
- [x] æ¯æ¬¡å¼€å§‹ï¼šåŠ è½½ `/cc-mirror-dev` skill + è¯» CLAUDE.md
- [x] æ¯æ¬¡ç»“æŸï¼šæ›´æ–° CLAUDE.md çš„"å½“å‰çŠ¶æ€" + git commit

---

## å¿«é€Ÿå‚è€ƒ

```bash
# å¼€å‘ session å¼€å§‹
cd ~/ä¸ªäººé¡¹ç›®/cc-mirror
# åœ¨ Claude Code é‡Œï¼š/cc-mirror-dev

# å®‰è£…ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
pip install -e ".[dev]"

# è¿è¡Œæµ‹è¯•ï¼ˆæœ€å°ï¼‰
python -m pytest tests/ -v

# Phase 0 éªŒæ”¶
cc-mirror scan --claude-dir ~/.claude \
  --project -Users-nature------Towow --verbose

# Phase 1 éªŒæ”¶
cc-mirror analyze --claude-dir ~/.claude \
  --project -Users-nature------Towow \
  --budget 20 --verbose

# çœ‹ DBï¼ˆè°ƒè¯•ï¼‰
sqlite3 mirror.db ".tables"
sqlite3 mirror.db "SELECT COUNT(*) FROM sessions"
sqlite3 mirror.db "SELECT COUNT(*) FROM corrections WHERE is_candidate_correction=1"
```

---

## å·¥ä½œæµåŸåˆ™ï¼ˆæ¯æ¬¡æ‰§è¡Œå‰é»˜è¯»ï¼‰

1. **è‡ªå·±æ˜¯ç¬¬ä¸€ç”¨æˆ·**ï¼šæµ‹è¯• = åœ¨ Towow æ•°æ®ä¸Šè¿è¡Œï¼Œçœ‹ç»“æœåˆä¸åˆç†
2. **æœ€å°æµ‹è¯•**ï¼šä¸è¦æ¯æ¬¡è·‘ full historyï¼Œå…ˆè·‘ fixturesï¼Œå†è·‘ 1 ä¸ª project
3. **å±•ç¤ºç»™ç”¨æˆ·çœ‹**ï¼šæ¯ä¸ª phase éªŒæ”¶ï¼ŒæŠŠå®é™…è¾“å‡ºç»™ç”¨æˆ·çœ‹ï¼Œä¸è¦è‡ªè¯´è‡ªè¯
4. **å·¥å…·ä¼˜å…ˆ**ï¼šæ”¹ schema åœ¨æ”¹ parser ä¹‹å‰ï¼›æ”¹ parser åœ¨æ”¹ CLI ä¹‹å‰
5. **git ä½œè¾¹ç•Œ**ï¼šæ¯ä¸ª phase å®Œæˆ â†’ commit â†’ æ›´æ–° CLAUDE.md
